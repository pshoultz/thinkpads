(window.webpackJsonp=window.webpackJsonp||[]).push([[2],{528:function(e,t,n){"use strict";var r=n(4),o=n.n(r),a=n(10),c=n(2),s=n(5),i=n(47),u=n(9);t.a=function(){var e=Object(a.a)(o.a.mark(function e(t){var n,r,a;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.logActivity,r=Object(i.a)(),e.next=4,r.WS_STATE.toArray();case 4:(a=e.sent).length>0&&(Object(u.a)({activity:n,level:"INFO",message:"Hydrating store..."}),a.forEach(function(e){var t=e.state,n=e.reducer,r=c.a[n.replace(s.SYNC_KEY,"")];void 0!==r&&c.b.dispatch(r.hydrate(t))}));case 6:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()},529:function(e,t,n){"use strict";n.r(t);var r=n(4),o=n.n(r),a=n(10),c=n(41),s=n(42),i=Object(a.a)(o.a.mark(function e(){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:["Created","Activated","Updated","Removed"].forEach(function(e){Object(s.a)(browser.tabs["on".concat(e)],function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];Object.values(c).forEach(function(t){t["onTab".concat(e)]&&t["onTab".concat(e)].apply(t,n)})})});case 2:case"end":return e.stop()}},e)})),u=function(){["Offline","Online"].forEach(function(e){var t=function(){Object.values(c).forEach(function(t){t["on".concat(e)]&&t["on".concat(e)]()})};window.removeEventListener(e.toLowerCase(),t),window.addEventListener(e.toLowerCase(),t)})},l=n(2),f=n(16),d=function(){Object(s.a)(browser.runtime.onMessage,function(e,t){return new Promise(function(n,r){e.type.includes("chromex.")||("get-state"===e.type&&function(e){var t=e.message,n=e.resolve;Array.isArray(t.payload)&&t.payload.length>0?n(t.payload.map(function(e){return Object(f.get)(l.b.getState(),e)})):n(Object(f.get)(l.b.getState(),t.payload))}({message:e,resolve:n}),Object.values(c).forEach(function(o){var a,c;(null===(a=o.onMessage)||void 0===a?void 0:a[e.type])&&(null===(c=o.onMessage)||void 0===c||c[e.type](e,{resolve:n,reject:r,sender:t}))}))})})},b=function(){browser.contextMenus&&Object(s.a)(browser.contextMenus.onClicked,function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];Object.values(c).forEach(function(e){e.onContextMenuClicked&&e.onContextMenuClicked.apply(e,t)})})},p=function(){["FocusChanged","Created"].forEach(function(e){Object(s.a)(browser.windows["on".concat(e)],function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];Object.values(c).forEach(function(t){t["onWindow".concat(e)]&&t["onWindow".concat(e)].apply(t,n)})})})},v=n(5),O=Object(a.a)(o.a.mark(function e(){var t,n,r,a,i;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];Object.values(c).forEach(function(e){e.onWebRequestBeforeRequest&&e.onWebRequestBeforeRequest.apply(e,t)})},Object(s.a)(browser.webRequest.onBeforeRequest,t,v.FILTER,["requestBody"]),n=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];Object.values(c).forEach(function(e){e.onWebRequestHeadersReceived&&e.onWebRequestHeadersReceived.apply(e,t)})},Object(s.a)(browser.webRequest.onHeadersReceived,n,v.FILTER,["responseHeaders"]),r=[function(){var e=Object.values(c).find(function(e){return e.onWebRequestAuthRequired});return e.onWebRequestAuthRequired.apply(e,arguments)},v.FILTER,[v.IS_CHROME?"asyncBlocking":"blocking"]],s.a.apply(void 0,[browser.webRequest.onAuthRequired].concat(r)),a=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];Object.values(c).forEach(function(e){e.onProxyError&&e.onProxyError.apply(e,t)})},v.IS_CHROME?Object(s.a)(browser.proxy.onProxyError,a):Object(s.a)(browser.proxy.onError,a),i=[function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];Object.values(c).forEach(function(e){e.onWebRequestCompleted&&e.onWebRequestCompleted.apply(e,t)})},v.FILTER],s.a.apply(void 0,[browser.webRequest.onCompleted].concat(i));case 12:case"end":return e.stop()}},e)})),w=function(){v.IS_CHROME&&Object(s.a)(browser.permissions.onAdded,function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];Object.values(c).forEach(function(e){e.onPermissionAdded&&e.onPermissionAdded.apply(e,t)})})};n.d(t,"tabs",function(){return i}),n.d(t,"connectivity",function(){return u}),n.d(t,"runtime",function(){return d}),n.d(t,"contextMenus",function(){return b}),n.d(t,"windows",function(){return p}),n.d(t,"webRequest",function(){return O}),n.d(t,"permissions",function(){return w})},808:function(e,t,n){e.exports=n(809)},809:function(e,t,n){"use strict";n.r(t),function(e){var t=n(4),r=n.n(t),o=n(20),a=n(10),c=n(26),s=n(191),i=n(96),u=n(47),l=n(2),f=n(5),d=n(529),b=n(528),p=n(95),v=n(111),O=n(9),w=n(41),h=n(85);Object(a.a)(r.a.mark(function e(){return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return Object(s.wrapStore)(l.b,{portName:Object({NODE_ENV:"production",PUBLIC_URL:""}).REACT_APP_REDUX_PORT||"WS_BROWSER_EXTENSION_STORE"}),setTimeout(function(){l.b.dispatch(l.a.bgReady.set(!0))},4e3),Object(p.a)(),e.prev=3,e.next=6,Object(u.b)();case 6:e.next=12;break;case 8:e.prev=8,e.t0=e.catch(3),Object(O.a)({activity:"background_setup",level:"ERROR",message:"Initializing db threw ".concat(JSON.stringify(e.t0))}),l.b.dispatch(l.a.view.set("firefox-in-private-mode"===e.t0.message?"FirefoxPrivateMode":"SomethingWeird"));case 12:return e.next=14,Object(b.a)({logActivity:"background_setup"});case 14:return i.a.GLOBAL_ERROR_LOG&&window.addEventListener("error",function(e){Object(O.a)({activity:"background_setup",level:"ERROR",message:"Event listener caught window err: ".concat(e)})}),e.t1=c.a,e.next=18,i.a.API_URL;case 18:return e.t2=e.sent,e.next=21,i.a.ASSETS_URL;case 21:return e.t3=e.sent,e.next=24,i.a.BACKUP_API_URL;case 24:return e.t4=e.sent,e.next=27,i.a.BACKUP_ASSETS_URL;case 27:return e.t5=e.sent,e.t6=l.b.getState().session.session_auth_hash,e.next=31,i.a.API_CALL_MIN_INTERVAL;case 31:return e.t7=e.sent,e.t8=f.IS_CHROME?"chrome":"firefox",e.t9={apiUrl:e.t2,assetsUrl:e.t3,backupApiUrl:e.t4,backupAssetsUrl:e.t5,sessionAuthHash:e.t6,apiCallMinInterval:e.t7,platform:e.t8},e.t1.setConfig.call(e.t1,e.t9),e.next=37,Promise.all(Object.values(w).map(function(e){return e.initialize?e.initialize():Promise.resolve()}));case 37:return e.next=39,Promise.all(Object.values(d).map(function(e){return e()}));case 39:Object(v.c)()||Object(v.b)(),l.b.getState().missingUserFilter||µBlock.selectedFilterLists.includes("user-filters")||(Object(h.updateFilterLists)({toSelect:[].concat(Object(o.a)(µBlock.selectedFilterLists),["user-filters"])}),l.b.dispatch(l.a.missingUserFilter.set(!0))),l.b.dispatch(l.a.bgReady.set(!0));case 42:case"end":return e.stop()}},e,null,[[3,8]])}))(),"production"!==e.NODE_ENV&&n.e(3).then(n.bind(null,820)).then(function(e){return e.default()})}.call(this,n(64))}},[[808,5,0]]]);